
<!doctype html>
<html lang="it" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Appunti completi del corso di Laboratorio di Reti di calcolatori, Università degli Studi di Milano. Apparati di rete, Cablaggi, DHCP, Subnetting, Routing, OSPF, RIP, VLAN, NAT, ACL e configurazioni Cisco.">
      
      
        <meta name="author" content="Emiddio Ingenito">
      
      
        <link rel="canonical" href="https://emikodes-UniMI.github.io/retilab/NAT/">
      
      
        <link rel="prev" href="../DHCP/">
      
      
        <link rel="next" href="../Routing/">
      
      
        
      
      
      <link rel="icon" href="../branding/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>NAT (Network Address Translation) - Appunti Laboratorio Reti di calcolatori - Emiddio Ingenito</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="red">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#nat-network-address-translation" class="md-skip">
          Vai al contenuto
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Intestazione">
    <a href=".." title="Appunti Laboratorio Reti di calcolatori - Emiddio Ingenito" class="md-header__button md-logo" aria-label="Appunti Laboratorio Reti di calcolatori - Emiddio Ingenito" data-md-component="logo">
      
  <img src="../branding/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Appunti Laboratorio Reti di calcolatori - Emiddio Ingenito
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              NAT (Network Address Translation)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="red"  aria-label="Passa alla modalità chiara"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Passa alla modalità chiara" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="red"  aria-label="Passa alla modalità scura"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Passa alla modalità scura" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Cerca" placeholder="Cerca" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Cerca">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Condividi" aria-label="Condividi" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Cancella" aria-label="Cancella" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inizializza la ricerca
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/emikodes-UniMI/retilab/" title="Apri repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    emikodes-UniMI/retilab
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigazione" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Appunti Laboratorio Reti di calcolatori - Emiddio Ingenito" class="md-nav__button md-logo" aria-label="Appunti Laboratorio Reti di calcolatori - Emiddio Ingenito" data-md-component="logo">
      
  <img src="../branding/logo.png" alt="logo">

    </a>
    Appunti Laboratorio Reti di calcolatori - Emiddio Ingenito
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/emikodes-UniMI/retilab/" title="Apri repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    emikodes-UniMI/retilab
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Appunti Laboratorio di Reti di Calcolatori - UniMI
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ACL/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ACL
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Apparati%20di%20rete/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Apparati di rete
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cablaggi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cablaggi
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../DHCP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DHCP
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    NAT (Network Address Translation)
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    NAT (Network Address Translation)
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Indice">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Indice
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#nat-statico" class="md-nav__link">
    <span class="md-ellipsis">
      
        NAT Statico:
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NAT Statico:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#funzionamento-del-nat-statico" class="md-nav__link">
    <span class="md-ellipsis">
      
        Funzionamento del NAT Statico:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configurazione-nat-statico-in-packet-tracer" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configurazione NAT statico in Packet Tracer:
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Routing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Routing
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../VLAN/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    VLAN
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/emikodes-UniMI/retilab/edit/main/docs/NAT.md" title="Modifica" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="nat-network-address-translation">NAT (Network Address Translation)<a class="headerlink" href="#nat-network-address-translation" title="Permanent link">&para;</a></h1>
<p>Il protocollo IPv4 prevede l’assegnazione ad ogni dispositivo connesso in rete di un indirizzo a 32 bit, lunghezza sufficiente a definire circa 4,3 miliardi di indirizzi unici.</p>
<p>La rapida espansione di internet ha generato la necessità di più indirizzi univoci, motivo per il quale è iniziata la migrazione ad IPv6.</p>
<p>Per prolungare la vita di IPv4, sono stati introdotti gli indirizzi IP privati.</p>
<p>L'idea alla base è semplice: non è necessario che ogni dispositivo (stampante, PC aziendale, smartphone domestico) abbia un indirizzo IP pubblico univoco raggiungibile da tutto il mondo, è sufficiente che sia identificabile univocamente solo all'interno della sua rete locale (LAN).</p>
<p>Lo standard <strong>RFC 1918</strong> ha riservato tre blocchi di indirizzi specifici per l'uso privato, riutilizzabili all'infinito in reti diverse, purché isolate tra loro.</p>
<blockquote>
<p><strong>IPv4 Private IP Ranges (RFC 1918)</strong></p>
<ul>
<li><strong>Class A Block:</strong> <code>10.0.0.0</code> – <code>10.255.255.255</code> (CIDR: <code>10.0.0.0/8</code>)</li>
<li><strong>Class B Block:</strong> <code>172.16.0.0</code> – <code>172.31.255.255</code> (CIDR: <code>172.16.0.0/12</code>)</li>
<li><strong>Class C Block:</strong> <code>192.168.0.0</code> – <code>192.168.255.255</code> (CIDR: <code>192.168.0.0/16</code>)</li>
</ul>
</blockquote>
<div class="admonition warning">
<p class="admonition-title">Non Instradabilità</p>
<p>Gli indirizzi privati <strong>non sono instradabili su Internet</strong>. I router dei provider (ISP) sono configurati per scartare (drop) qualsiasi pacchetto che abbia come destinazione o sorgente un indirizzo IP appartenente a queste classi. Ciò significa che un dispositivo a cui è assegnato un indirizzo IP privato, non potrà comunicare con la rete pubblica utilizzando quello stesso indirizzo.</p>
</div>
<p>La soluzione è il NAT, un meccanismo di traduzione di indirizzi pubblici in privati e viceversa, adottato dai router di confine d’area al fine di permettere la navigazione in rete di dispositivi a cui è assegnato un indirizzo privato.</p>
<h2 id="nat-statico">NAT Statico:<a class="headerlink" href="#nat-statico" title="Permanent link">&para;</a></h2>
<p><img alt="" src="https://ipcisco.com/wp-content/uploads/2018/10/nat-types-static-nat-ipcisco.jpg" /></p>
<p>Associa ad ogni dispositivo all’interno di una rete privata (indirizzato al suo interno da un indirizzo privato), un indirizzo IP pubblico fisso.</p>
<p>Mappatura 1 a 1, necessito di tanti indirizzi IP pubblici tanti quanti sono gli host che vogliono comunicare in rete (un indirizzo pubblico per ogni indirizzo privato).</p>
<p>Utilizzato principalmente in ambiente server, assegnando ad ognuno un indirizzo IP pubblico fisso.</p>
<h3 id="funzionamento-del-nat-statico">Funzionamento del NAT Statico:<a class="headerlink" href="#funzionamento-del-nat-statico" title="Permanent link">&para;</a></h3>
<p>Un client con indirizzo IP <code>8.8.8.8</code> (supponiamo pubblico e statico), richiede un servizio fornito dal server con indirizzo IP pubblico <code>200.200.200.1</code>:</p>
<ol>
<li>
<p>Il client invia un pacchetto attraverso internet.</p>
<p><strong>Source:</strong> <code>8.8.8.8</code></p>
<p><strong>Destination:</strong> <code>200.200.200.1</code> (IP Pubblico del Server)</p>
</li>
<li>
<p>Il router della rete in cui si trova il server, riceve il pacchetto sull'interfaccia <em>Outside</em>.</p>
<p>Controlla la NAT Table e trovala regola statica di conversione 200.200.200.1 → 192.168.0.1: modifica l'header del pacchetto</p>
<p><strong>Source:</strong> <code>8.8.8.8</code> (Invariato)</p>
<p><strong>New Destination:</strong> <code>192.168.0.1</code> (IP Privato)</p>
</li>
<li>
<p>Il router cerca nella routing table <code>192.168.0.1</code> , inoltra correttamente il pacchetto al server.</p>
</li>
<li>
<p>Il server risponde con la pagina web inviando un pacchetto al suo gateway (il router).</p>
<p><strong>Source:</strong> <code>192.168.0.1</code> (IP Privato)</p>
<p><strong>Destination:</strong> <code>8.8.8.8</code></p>
</li>
<li>
<p>Il router riceve il pacchetto sull'interfaccia <em>Inside</em>.
Ricontrolla la NAT Table, sostituisce l’indirizzo IP Privato del server al fine di renderlo instradabile pubblicamente:</p>
<ul>
<li><strong>New Source:</strong> <code>200.200.200.1</code> (IP Pubblico)</li>
<li><strong>Destination:</strong> <code>8.8.8.8</code> (Invariato)</li>
</ul>
</li>
<li>Il pacchetto viaggia su Internet. Il Client riceve la risposta credendo che sia arrivata da <code>200.200.200.1</code></li>
</ol>
<h3 id="configurazione-nat-statico-in-packet-tracer">Configurazione NAT statico in Packet Tracer:<a class="headerlink" href="#configurazione-nat-statico-in-packet-tracer" title="Permanent link">&para;</a></h3>
<p>Per abilitare il NAT, il router di confine d’area della LAN deve sapere quali interfacce appartengono alla rete interna (da tradurre) e quali alla rete esterna (internet).</p>
<p>Marcatura dell’interfaccia connessa alla LAN:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>Router(config)# interface [GigabitEthernet0/0]
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>Router(config-if)# ip nat inside
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>Router(config-if)# exit
</span></code></pre></div>
<p>Marcatura dell’interfaccia connessa ad internet:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>Router(config)# interface [Serial0/0/0]
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>Router(config-if)# ip nat outside
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>Router(config-if)# exit
</span></code></pre></div>
<p>In modalità di configurazione globale, impostiamo manualmente le regole di conversione tra IP Privati e pubblici.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>Router(config)# ip nat inside source static PRIVATE_IP PUBLIC_IP
</span></code></pre></div>
<h1 id="nat-dinamico">NAT Dinamico:<a class="headerlink" href="#nat-dinamico" title="Permanent link">&para;</a></h1>
<p><img alt="" src="https://ipcisco.com/wp-content/uploads/2018/10/nat-types-dynamic-nat-www.ipcisco.jpg" /></p>
<p>All’interno del router di confine d’area della LAN, è caricato un pool (insieme) di indirizzi IP pubblici, ed ogni host interno alla rete, potrà comunicare all’esterno utilizzando uno degli IP presenti in esso.</p>
<p>Esempio: potrei aver acquistato e caricato sul router 3 indirizzi IP pubblici, ma aver 50 host configurati nella LAN, come possono navigare tutti contemporaneamente su internet?</p>
<p>Non è possibile, il mio router permetterà solo a 3 host contemporaneamente di comunicare in rete.</p>
<p>Per configurare NAT Dinamico pertanto servono:</p>
<ul>
<li>Pool di indirizzi pubblici</li>
<li>Elenco di indirizzi privati che andranno tradotti</li>
</ul>
<blockquote>
<p>Attenzione! Non specifico una mappatura 1 a 1 come nel caso del NAT Statico, perchè l’assegnazione di un indirizzo pubblico piuttosto che un’altro, è dinamica, “casuale”, non definita univocamente tramite mappatura pre-configurata.
</p>
</blockquote>
<h3 id="configurazione-nat-dinamico-in-packet-tracer">Configurazione NAT Dinamico in Packet Tracer:<a class="headerlink" href="#configurazione-nat-dinamico-in-packet-tracer" title="Permanent link">&para;</a></h3>
<p>Marcatura dell’interfaccia connessa alla LAN:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>Router(config)# interface [GigabitEthernet0/0]
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>Router(config-if)# ip nat inside
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>Router(config-if)# exit
</span></code></pre></div>
<p>Marcatura dell’interfaccia connessa ad internet:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>Router(config)# interface [Serial0/0/0]
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>Router(config-if)# ip nat outside
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>Router(config-if)# exit
</span></code></pre></div>
<p>Configuro una ACL contenente l’elenco degli indirizzi d’origine che andranno tradotti (a cui vogliamo permettere la navigazione in internet).</p>
<p><strong>Sintassi del comando: <code>access-list numeroACL permit/deny SOTTOINSIEME_INDIRIZZI_DA_TRADURRE WILDCARD_MASK</code></strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a># Definisco quali IP possono essere tradotti
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>Router(config)# access-list 110 permit ip 192.168.0.0 0.0.0.15 any
</span></code></pre></div>
<p>Per concedere a tutti gli host configurati nella LAN di accedere ad internet (traduzione di tutti gli host nella LAN), posso utilizzare la sintassi</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>Router(config)# access-list numeroACL permit ip any any
</span></code></pre></div>
<p>Configurazione Pool di indirizzi pubblici e abilitazione del NAT dinamico:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>Router(config)# ip nat pool NAME FIRST_IP_ADDRESS LAST_IP_ADDRESS netmask SUBNET_MASK
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>Router(config)# ip nat inside source list ACL_NUMBER pool NAME (Stesso nome dato al POOL di indirizzi)
</span></code></pre></div>
<h1 id="nat-overload-pat-port-address-translation">NAT “Overload” (PAT, Port Address Translation):<a class="headerlink" href="#nat-overload-pat-port-address-translation" title="Permanent link">&para;</a></h1>
<p><img alt="" src="https://ipcisco.com/wp-content/uploads/2018/10/nat-types-pat-ipcisco.jpg" /></p>
<p>Singolo indirizzo IP Pubblico (Assegnato dall’ISP e configurato sul Router), con cui tutti i dispositivi nella LAN comunicano.</p>
<p>Per distinguere quale dispositivo richiede la connessione, e a quale di conseguenza inoltrare i pacchetti in entrata (essendo che ora tutti gli host nella LAN comunicano all’esterno utilizzando lo stesso IP Pubblico), viene applicato un meccanismo di conversione dei numeri di porta detto PAT, con l’utilizzo di una PAT table.</p>
<h3 id="funzionamento-del-nat-overload">Funzionamento del NAT “Overload”<a class="headerlink" href="#funzionamento-del-nat-overload" title="Permanent link">&para;</a></h3>
<p>Due client nella rete interna, PC A (<code>192.168.0.1</code>) e PC B (<code>192.168.0.2</code>), vogliono visitare contemporaneamente lo stesso sito web (<code>8.8.8.8</code>).</p>
<p>Il router ha un solo indirizzo IP Pubblico: <code>200.200.200.1</code></p>
<ol>
<li>
<p><strong>Invio richieste:</strong>
Il PC A apre il browser, il S.O assegna al processo una porta casuale (es. 3001).
<strong>Source:</strong> <code>192.168.0.1 : 3001</code> (IP Privato : Porta A)
<strong>Destination:</strong> <code>8.8.8.8 : 80</code> (IP Web Server : Porta HTTP)
Il Router riceve il pacchetto del PC A, nota che è da inoltrare al di fuori della LAN, sostituisce il suo IP pubblico nell’header IP e assegna una nuova porta libera.</p>
<p>New <strong>Source:</strong> <code>200.200.200.1 : 6001</code> (IP Pubblico : Porta Assegnata dal Router)
<strong>Destination:</strong> <code>8.8.8.8 : 80</code> (Invariato)</p>
<p>Memorizza tale associazione nella NAT Table (che ora memorizzerà le associazioni IP-Port).</p>
<p>Anche il PC B apre il browser. Per coincidenza, usa la stessa porta sorgente interna (3001).
<strong>Source:</strong> <code>192.168.0.2 : 3001</code> (IP Privato : Porta B)
<strong>Destination:</strong> <code>8.8.8.8 : 80</code>
Il router assegna una nuova porta libera (es. 6002), e sostituisce il proprio IP
New <strong>Source:</strong> <code>200.200.200.1 : 6002</code> (IP Pubblico : Porta Diversa)
<strong>Destination:</strong> <code>8.8.8.8 : 80</code>
Memorizza la nuova associazione.</p>
<p>I due pacchetti vengono inoltrati sulla rete</p>
</li>
<li>
<p><strong>Reply:</strong></p>
<p>Il Server risponde alla prima richiesta:
<strong>Source:</strong> <code>8.8.8.8 : 80</code>
<strong>Destination:</strong> <code>200.200.200.1 : 6001</code>
Il router riceve il pacchetto, legge la Porta di Destinazione (6001).</p>
<p>Consultando la NAT Table, rileva che a <code>200.200.200.1: 6001</code>, corrisponde l’host A: <code>192.168.0.1 : 3001</code>.
<strong>Source:</strong> <code>8.8.8.8 : 80</code></p>
<p>New <strong>Destination:</strong> <code>192.168.0.1 : 3001</code></p>
<p>Il pacchetto viene consegnato a PC A.</p>
<p>La stessa procedura si ripete per il PC B.</p>
</li>
</ol>
<h3 id="configurazione-nat-overload-in-packet-tracer">Configurazione NAT “Overload” in Packet Tracer:<a class="headerlink" href="#configurazione-nat-overload-in-packet-tracer" title="Permanent link">&para;</a></h3>
<p>Marcatura dell’interfaccia connessa alla LAN:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>Router(config)# interface [GigabitEthernet0/0]
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>Router(config-if)# ip nat inside
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>Router(config-if)# exit
</span></code></pre></div>
<p>Marcatura dell’interfaccia connessa ad internet:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>Router(config)# interface [Serial0/0/0]
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>Router(config-if)# ip nat outside
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>Router(config-if)# exit
</span></code></pre></div>
<p>Configuro una ACL contenente l’elenco degli indirizzi d’origine che andranno tradotti (a cui vogliamo permettere la navigazione in internet).</p>
<p><strong>Sintassi del comando: <code>access-list numeroACL permit/deny SOTTOINSIEME_INDIRIZZI_DA_TRADURRE WILDCARD_MASK</code></strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>Router(config)# access-list 110 permit ip 192.168.0.0 0.0.0.15 any
</span></code></pre></div>
<p>Per concedere a tutti gli host configurati nella LAN di accedere ad internet (traduzione di tutti gli host nella LAN), posso utilizzare la sintassi</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>Router(config)# access-list numeroACL permit ip any any
</span></code></pre></div>
<p>Configurazione del servizio NAT sull’interfaccia:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>Router(config)# ip nat inside source list &lt;ACL_ID&gt; interface &lt;Interface_ID&gt; overload
</span></code></pre></div>
<p>Tutto il traffico definito dall’ACL, verrà inoltrato verso l’esterno traducendo gli indirizzi privati con l’indirizzo pubblico dell’interfaccia FastEthernet 0/0.</p>
<h1 id="port-forwarding">Port Forwarding<a class="headerlink" href="#port-forwarding" title="Permanent link">&para;</a></h1>
<p>Nel NAT Dinamico ed Overload, le traduzioni nella NAT Table vengono create solo quando il traffico parte dall’interno della LAN e raggiunge l’esterno (Mentre nel NAT Statico, sono configurate manualmente dall’amministratore di rete, e rimangono indefinitamente nella memoria del router).</p>
<p>Per esporre un host al di fuori della rete privata, in caso d’uso di NAT Dinamico o Overload, dobbiamo utilizzare la funzionalità di port forwarding, ed impostare manualmente una regola di traduzione.</p>
<p>Mapping tra indirizzo esterno e porta → indirizzo interno e porta servizio</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>Router(config)# ip nat inside source static tcp [IPInterno] [PortaInterna] [IPEsterno] [PortaEsterna]
</span></code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Torna su
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Emiddio Ingenito - Emikodes</a>
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.expand", "navigation.top", "navigation.tracking", "toc.integrate", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.action.edit"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copiato", "clipboard.copy": "Copia", "search.result.more.one": "1 altro in questa pagina", "search.result.more.other": "# altri in questa pagina", "search.result.none": "Nessun documento trovato", "search.result.one": "1 documento trovato", "search.result.other": "# documenti trovati", "search.result.placeholder": "Scrivi per iniziare a cercare", "search.result.term.missing": "Non presente", "select.version": "Seleziona la versione"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js"></script>
      
    
  </body>
</html>